---
import { ViewTransitions } from "astro:transitions";
import BaseHead from "../components/BaseHead.astro";
import Header from "../components/Header.astro";
import Footer from "../components/Footer.astro";
import GraphComponent from "../components/GraphComponent";

const graph = await import("../pages/graph.json");
const graphData = await graph.GET({}).then((response) => response.json());
interface Props {
  title: string;
  description: string;
}

const { title, description } = Astro.props;
---

<html lang="en">
  <head>
    <BaseHead title={title} description={description} />
    <ViewTransitions />

    <style>
      article {
        max-width: 720px;
        margin: 0 auto;
      }

      .graph-wrapper {
        width: calc(100% - 2em);
        max-width: calc(720px - 2em);
        margin: 0 1em;
        aspect-ratio: 16/10;
        background: var(--nord5);

        @media (min-width: 720px) {
          margin: 0 auto;
        }
        @media (min-width: 1200px) {
          position: fixed;
          z-index: 3;
          bottom: 0;
          right: 0;
          margin: 0;
          width: calc((100vw - 720px) / 2 - 1em);
          max-width: 400px;
          aspect-ratio: 1;
        }
      }
    </style>
  </head>

  <body>
    <Header />
    <slot name="after-header" />
    <main>
      <div class="graph-wrapper" transition:persist="graph">
        <GraphComponent data={graphData} client:only="react" />
      </div>
      <article>
        <slot />
      </article>
      <Footer />
    </main>
  </body>
</html>
